import{b as g,a as t,k as o,q as d,o as u}from"./vendor-yjUBYCCz.js";import{_ as w}from"./index-BHSFjLNm.js";const c={name:"SwaggerPage",data(){return{title:"Swagger 工具",apiUrl:"",baseUrl:"",ui:null,uiReady:!1}},mounted(){document.title=this.title,this.ensureSwaggerUi().then(()=>{this.uiReady=!0})},methods:{async onLoad(){if(!this.apiUrl){alert("请输入 swagger-api 地址");return}try{const s=await this.fetchSpecWithCors(this.apiUrl);if(this.baseUrl){const e=Array.isArray(s.servers)?s.servers.slice():[];s.servers=[{url:this.baseUrl},...e.filter(r=>r.url!==this.baseUrl)]}await this.renderSwagger(s)}catch(s){console.error(s),alert("读取 swagger-api 失败，请检查地址或稍后再试")}},async renderSwagger(s){var e,r,i,a;if(await this.ensureSwaggerUi(),!window.SwaggerUIBundle)throw new Error("SwaggerUIBundle 未加载");if(this.ui&&((e=this.ui)!=null&&e.getSystem))try{(a=(i=(r=this.ui)==null?void 0:r.layoutPlugin)==null?void 0:i.unregister)==null||a.call(i)}catch{}this.ui=window.SwaggerUIBundle({spec:s,dom_id:"#swagger-ui",deepLinking:!0,presets:window.SwaggerUIBundle.presets?window.SwaggerUIBundle.presets.apis:void 0,layout:"BaseLayout",requestInterceptor:l=>l})},async ensureSwaggerUi(){if(!document.querySelector('link[data-swagger-ui="css"]')){const s=document.createElement("link");s.rel="stylesheet",s.href="https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui.css",s.setAttribute("data-swagger-ui","css"),document.head.appendChild(s)}window.SwaggerUIBundle||await new Promise((s,e)=>{const r=document.createElement("script");r.src="https://cdn.jsdelivr.net/npm/swagger-ui-dist@5/swagger-ui-bundle.js",r.onload=s,r.onerror=e,document.body.appendChild(r)})},async fetchSpecWithCors(s){const e=await fetch(s,{mode:"cors"});if(!e.ok)throw new Error("swagger-api 获取失败");return await e.json()}}},p={class:"swagger-wrap"},h={class:"topbar"},m={class:"actions"},f={class:"content"},U={id:"swagger-ui",ref:"swaggerEl",class:"swagger-ui-box"};function b(s,e,r,i,a,l){return u(),g("div",p,[t("div",h,[e[5]||(e[5]=t("div",null,"Swagger 工具",-1)),t("div",m,[e[3]||(e[3]=t("label",{class:"lbl"},"swagger-api地址",-1)),o(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>a.apiUrl=n),class:"input",placeholder:"https://example.com/v3/api-docs 或 swagger.json"},null,512),[[d,a.apiUrl]]),e[4]||(e[4]=t("label",{class:"lbl"},"swagger-api基础地址",-1)),o(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>a.baseUrl=n),class:"input",placeholder:"例如 https://api.example.com"},null,512),[[d,a.baseUrl]]),t("button",{class:"btn",onClick:e[2]||(e[2]=(...n)=>l.onLoad&&l.onLoad(...n))}," 确定 ")])]),t("div",f,[t("div",U,null,512)])])}const v=w(c,[["render",b],["__scopeId","data-v-36eda9b0"]]);export{v as default};
